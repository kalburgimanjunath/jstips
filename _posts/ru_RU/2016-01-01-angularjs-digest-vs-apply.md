---
layout: post

title: AngularJs - `$digest` vs `$apply`
tip-number: 01
tip-username: loverajoel
tip-username-profile: https://github.com/loverajoel
tip-tldr: Количество и сложность JavaScript модулей и этапов сборки растет, а что насчет шаблонного кода в новых фреймворках?
tip-writer-support: https://www.coinbase.com/loverajoel

categories:
    - ru_RU
---

Одна из самых ценных особенностей AngularJS — двухстороннее связывание данных. Для того, чтобы это работало, AngularJS вычисляет изменения между моделью и представлением (view) с помощью циклов (`$digest`). Вам нужно понять этот концепт, чтобы понимать как работает фреймворк под капотом.

Angular оценивает изменения в каждом наблюдателе (watcher) всякий раз, когда срабатывает событие. Это называется `$digest` цикл.
Эта фаза одна из самых тяжелых по производительности и, если вам нужно вручную запустить новый цикл, вы должны выбрать оптимальный способ для конкретной ситуации.

### `$apply`

Этот метод ядра позволяет явно запустить цикл `$digest`. Это значит, что все наблюдатели проверены; все приложение начинает `$digest` цикл.
This core method lets you to start the digestion cycle explicitly. That means that all watchers are checked; the entire application starts the `$digest loop`. Internally, after executing an optional function parameter, it calls `$rootScope.$digest();`.

### `$digest`
В данном случае метод `$digest` запускает `$digest` цикл для текущей области видимости и всех вложенных. Области видимости уровнем выше не будут проверены и затронуты.

### Recommendations
- Используйте `$apply` или `$digest` только когда браузерные DOM события вызываются вне AngularJS.
- Передавайте функциональные выражения в `$apply`, у этого метода есть механизм ловли ошибок и он позволяет интегрировать изменения в `$digest` цикле.

```javascript
$scope.$apply(() => {
	$scope.tip = 'Javascript Tip';
});
```

- Если вам нужно обновить только текущую область видимости и ее наследников, используйте `$digest`, и недопускайте новый digest-цикл для всего приложения. Это очевидная выгода в производительности.
- `$apply()` — тяжелый процесс для компьютера и может стать причиной слабой производительности, при большом количестве связей.
- Если вы используйте >AngularJS 1.2.X версии, используйте встроенный метод `$evalAsync`, который вызовет выражение в текущем цикле или следующем. Это улучшит производительность приложения.
